knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
# Set seed for reproducibility
set.seed(123)
# Create simulated SAT scores for admitted students across three college types
# Scale is 400-1600 for total SAT
# rnorm generates random numbers, in this case, 100 numbers
public_college <- rnorm(100, mean = 1350, sd = 120)
private_college <- rnorm(100, mean = 1450, sd = 100)
community_college <- rnorm(100, mean = 1050, sd = 150)
# Combine into a single dataframe
admissions_data <- data.frame(
college_type = factor(rep(c("Public", "Private", "Community"), each = 100)),
sat_score = c(public_college, private_college, community_college)
)
# Ensure SAT scores are within realistic range (400-1600)
admissions_data$sat_score <- pmin(pmax(admissions_data$sat_score, 400), 1600)
# Quick look at the data
head(admissions_data)
# Summary statistics by college type
admission_summary <- admissions_data |>
group_by(college_type) |>
summarize(
mean_score = mean(sat_score),
median_score = median(sat_score),
sd_score = sd(sat_score),
min_score = min(sat_score),
max_score = max(sat_score)
)
print(admission_summary)
# Create density plot showing overlapping distributions
ggplot(admissions_data, aes(x = sat_score, fill = college_type)) +
geom_density(alpha = 0.5) +
labs(
title = "SAT Score Distributions by College Type",
subtitle = "Are these differences statistically significant?",
x = "SAT Score (400-1600 scale)",
y = "Density",
fill = "College Type"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Create boxplot for another view
ggplot(admissions_data, aes(x = college_type, y = sat_score, fill = college_type)) +
geom_boxplot() +
labs(
title = "SAT Scores by College Type",
x = "College Type",
y = "SAT Score"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Run one-way ANOVA
anova_result <- aov(sat_score ~ college_type, data = admissions_data)
summary(anova_result)
# Your ANOVA has:
# df1 (between groups) = 2
# df2 (within groups/residuals) = 297
# Common alpha levels: 0.05, 0.01, 0.001
# Critical values at different significance levels:
critical_f_05 <- qf(0.95, df1 = 2, df2 = 297)
critical_f_01 <- qf(0.99, df1 = 2, df2 = 297)
critical_f_001 <- qf(0.999, df1 = 2, df2 = 297)
cat("Here are the Critical F-values:\n")
cat("alpha of α = 0.05: ", round(critical_f_05, 3), "\n")
cat("alpha of α = 0.01: ", round(critical_f_01, 3), "\n")
cat("alpha ofα = 0.001:", round(critical_f_001, 3), "\n")
cat("The F-statistic is: 284.3\n")
cat("Ratio to most extreme critical value (α=0.001) to the F statistic:", round(284.3/critical_f_001, 1), "x\n")
# Tukey's HSD test to see which specific pairs of college types differ
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
