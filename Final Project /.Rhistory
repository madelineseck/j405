knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
# Set seed for reproducibility
set.seed(123)
# Create simulated SAT scores for admitted students across three college types
# Scale is 400-1600 for total SAT
# rnorm generates random numbers, in this case, 100 numbers
public_college <- rnorm(100, mean = 1350, sd = 120)
private_college <- rnorm(100, mean = 1450, sd = 100)
community_college <- rnorm(100, mean = 1050, sd = 150)
# Combine into a single dataframe
admissions_data <- data.frame(
college_type = factor(rep(c("Public", "Private", "Community"), each = 100)),
sat_score = c(public_college, private_college, community_college)
)
# Ensure SAT scores are within realistic range (400-1600)
admissions_data$sat_score <- pmin(pmax(admissions_data$sat_score, 400), 1600)
# Quick look at the data
head(admissions_data)
# Summary statistics by college type
admission_summary <- admissions_data |>
group_by(college_type) |>
summarize(
mean_score = mean(sat_score),
median_score = median(sat_score),
sd_score = sd(sat_score),
min_score = min(sat_score),
max_score = max(sat_score)
)
print(admission_summary)
# Create density plot showing overlapping distributions
ggplot(admissions_data, aes(x = sat_score, fill = college_type)) +
geom_density(alpha = 0.5) +
labs(
title = "SAT Score Distributions by College Type",
subtitle = "Are these differences statistically significant?",
x = "SAT Score (400-1600 scale)",
y = "Density",
fill = "College Type"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Create boxplot for another view
ggplot(admissions_data, aes(x = college_type, y = sat_score, fill = college_type)) +
geom_boxplot() +
labs(
title = "SAT Scores by College Type",
x = "College Type",
y = "SAT Score"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Run one-way ANOVA
anova_result <- aov(sat_score ~ college_type, data = admissions_data)
summary(anova_result)
# Your ANOVA has:
# df1 (between groups) = 2
# df2 (within groups/residuals) = 297
# Common alpha levels: 0.05, 0.01, 0.001
# Critical values at different significance levels:
critical_f_05 <- qf(0.95, df1 = 2, df2 = 297)
critical_f_01 <- qf(0.99, df1 = 2, df2 = 297)
critical_f_001 <- qf(0.999, df1 = 2, df2 = 297)
cat("Here are the Critical F-values:\n")
cat("alpha of α = 0.05: ", round(critical_f_05, 3), "\n")
cat("alpha of α = 0.01: ", round(critical_f_01, 3), "\n")
cat("alpha ofα = 0.001:", round(critical_f_001, 3), "\n")
cat("The F-statistic is: 284.3\n")
cat("Ratio to most extreme critical value (α=0.001) to the F statistic:", round(284.3/critical_f_001, 1), "x\n")
# Tukey's HSD test to see which specific pairs of college types differ
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)
billboard <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQVR7XE8UGPh9EYKpSLzrNA0kXqcQo3AONREuc6mAAaHAu-8ia01STi_HrHgATfgJ5n9xUAUHPSl9ou/pub?gid=1077686609&single=true&output=csv Links to an external site.") |>
clean_names() |>
mutate(date_new = dmy(date)) |>
mutate(date_new = if_else(year(date_new) > 2024,  date_new - years(100), date_new)) |>
select(date_new, everything())
billboard <- read_csv("billboard.csv") |>
clean_names() |>
mutate(date_new = dmy(date)) |>
mutate(date_new = if_else(year(date_new) > 2024,  date_new - years(100), date_new)) |>
select(date_new, everything())
billboard_anova <- billboard |>
filter(!is.na(genre), !is.na(weeks_on_chart))
billboard <- read_csv("Billboard 2") |>
clean_names() |>
mutate(date_new = dmy(date)) |>
mutate(date_new = if_else(year(date_new) > 2024,  date_new - years(100), date_new)) |>
select(date_new, everything())
billboard <- read_csv("Billboard 2") |>
billboard <- read_csv("Billboard 2.csv")
billboard <- read_csv("billboard.csv")
library(tidyverse)
billboard <- read_csv("billboard.csv")
billboard <- read_csv("Billboard 2.csv")
billboard <- read_csv("Billboard2.csv")
view(Billboard2)
billboard <- read_csv("Billboard100.csv")
view(Billboard100)
view(Billboard100)
view(Billboard100)
view(Billboard100)
view(billboard)
avg_weeks <- aggregate(Weeks_on_Chart ~ Genre, data = df, FUN = mean)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = df, FUN = mean)
anova_result <- aov(Weeks.at.Number.One ~ CDR.Genre, data = df)
df$z_score <- scale(df$Weeks.at.Number.One)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = df, FUN = mean)
Error in model.frame.default(formula = Weeks.at.Number.One ~ CDR.Genre, :
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = df, FUN = mean)
class(df)
songs <- read.csv("billboard.csv")
songs <- read.csv("billboard.csv")
view(billboard)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = songs, FUN = mean)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = df, FUN = mean)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = songs, FUN = mean)
df <- as.data.frame(df)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre,
data = df, FUN = mean)
avg_weeks_sorted <- avg_weeks[order(-avg_weeks$Weeks.at.Number.One), ]
head(avg_weeks_sorted, 3)
avg_weeks_sorted <- avg_weeks[order(-avg_weeks$Weeks.at.Number.One), ]
head(avg_weeks_sorted, 3)
avg_weeks <- aggregate(Weeks.at.Number.One ~ CDR.Genre, data = df, FUN = mean)
avg_weeks_sorted <- avg_weeks[order(-avg_weeks$Weeks.at.Number.One), ]
head(avg_weeks_sorted, 3)
avg_weeks_sorted <- avg_weeks[order(-avg_weeks$Weeks.at.Number.One), ]
head(avg_weeks_sorted, 3)
anova_result <- aov(Weeks.at.Number.One ~ CDR.Genre, data = df)
anova_result <- aov(Weeks.at.Number.One ~ CDR.Genre, data = df)
df$z_score <- scale(df$Weeks.at.Number.One)
anova_result <- aov(Weeks.at.Number.One ~ CDR.Genre, data = df)
class(df)
class(df)
str(df)
class(df)
str(df)
names(df)
class(df)
str(df)
names(df)
anova_result <- aov(`Weeks at Number One` ~ CDR.Genre, data = df)
# Average weeks per genre
avg_weeks <- aggregate(`Weeks at Number One` ~ `CDR Genre`, data = df, FUN = mean)
pop_reggae <- df$`Weeks at Number One`[df$`CDR Genre` == "Pop;Reggae"]
pop_reggae <- df$`Weeks at Number One`[df$`CDR Genre` == "Pop;Reggae"]
t.test(pop_reggae, electronic_latin)
avg_weeks <- aggregate(`Weeks at Number One` ~ `CDR Genre`, data = df, FUN = mean)
df <- data.frame(
Song = c("Song1", "Song2", "Song3"),
Artist = c("Artist1", "Artist2", "Artist3"),
Weeks_at_Number_One = c(5, 10, 3),
CDR_Genre = c("Pop;Reggae", "Hip Hop;Reggae", "Electronic/Dance;Latin")
)
df <- data.frame(
Song = c("Song1", "Song2", "Song3"),
Artist = c("Artist1", "Artist2", "Artist3"),
Weeks_at_Number_One = c(5, 10, 3),
CDR_Genre = c("Pop;Reggae", "Hip Hop;Reggae", "Electronic/Dance;Latin")
)
str(df)
head(df)
pop_reggae <- df$Weeks_at_Number_One[df$CDR_Genre == "Pop;Reggae"]
electronic_latin <- df$Weeks_at_Number_One[df$CDR_Genre == "Electronic/Dance;Latin"]
t.test(pop_reggae, electronic_latin)
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
df <- data.frame(
Song = c("Song1", "Song2", "Song3"),
Artist = c("Artist1", "Artist2", "Artist3"),
Weeks_at_Number_One = c(5, 10, 3),
CDR_Genre = c("Pop;Reggae", "Hip Hop;Reggae", "Electronic/Dance;Latin")
)
# Average weeks per genre
avg_weeks <- aggregate(`Weeks at Number One` ~ `CDR Genre`, data = df, FUN = mean)
avg_weeks <- avg_weeks[order(-avg_weeks$`Weeks at Number One`), ]
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
colnames(df)
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
library(dplyr)
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
library(dplyr)
avg_weeks <- df %>%
group_by(CDR_Genre) %>%
summarize(mean_weeks = mean(Weeks_at_Number_One, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
df <- read.csv("billboard.csv", stringsAsFactors = FALSE)
library(dplyr)
pop_reggae <- df$Weeks_at_Number_One[df$CDR_Genre == "Pop;Reggae"]
hiphop_reggae <- df$Weeks_at_Number_One[df$CDR_Genre == "Hip Hop;Reggae"]
t.test(pop_reggae, hiphop_reggae)
df$Decade <- floor(df$Year / 10) * 10
df$Date <- as.Date(df$Date, format = "%Y-%m-%d")
df$Date <- as.Date(df$Date, format = "%Y-%m-%d")
df$Year <- as.numeric(format(df$Date, "%Y"))
df$Decade <- floor(df$Year / 10) * 10
df$Decade <- as.factor(df$Decade)
library(dplyr)
avg_weeks_decade <- df %>%
group_by(Decade) %>%
summarize(mean_weeks = mean(`Weeks at Number One`, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
df$Date <- as.Date(df$Date, format = "%Y-%m-%d")
df$Date <- as.Date(df$Date, format = "%Y-%m-%d")
df$Year <- as.numeric(format(df$Date, "%Y"))
df$Date <- as.Date(df$Date, format = "%Y-%m-%d")
df$Year <- as.numeric(format(df$Date, "%Y"))
df$Decade <- floor(df$Year / 10) * 10
df$Era <- ifelse(df$Year < 2000, "Older", "Recent")
df$Era <- as.factor(df$Era)
library(dplyr)
df %>%
group_by(Era) %>%
summarize(mean_weeks = mean(`Weeks at Number One`, na.rm = TRUE),
sd_weeks = sd(`Weeks at Number One`, na.rm = TRUE),
n = n())
library(dplyr)
avg_weeks_genre <- df %>%
group_by(`CDR Genre`) %>%
summarize(mean_weeks = mean(`Weeks at Number One`, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
avg_weeks_genre <- df %>%
group_by(`CDR Genre`) %>%
summarize(mean_weeks = mean(`Weeks at Number One`, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
colnames(df)
avg_weeks_genre <- df %>%
group_by(CDR.Genre) %>%
summarize(mean_weeks = mean(Weeks.at.Number.One, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
avg_weeks_genre <- df %>%
group_by(CDR.Genre) %>%
summarize(mean_weeks = mean(Weeks.at.Number.One, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
head(avg_weeks_genre, 3)
avg_weeks_genre <- df %>%
group_by(CDR.Genre) %>%
summarize(mean_weeks = mean(Weeks.at.Number.One, na.rm = TRUE)) %>%
arrange(desc(mean_weeks))
head(avg_weeks_genre, 3)
ED_Latin <- df[df$CDR.Genre == "Electronic/Dance;Latin", "Weeks.at.Number.One"]
HipHop_Reggae <- df[df$CDR.Genre == "Hip Hop;Reggae", "Weeks.at.Number.One"]
Pop_Reggae <- df[df$CDR.Genre == "Pop;Reggae", "Weeks.at.Number.One"]
t.test(ED_Latin, HipHop_Reggae)
ttest_ED_HipHop <- t.test(ED_Latin, HipHop_Reggae)
ED_Latin <- df[df$CDR.Genre == "Electronic/Dance;Latin", "Weeks.at.Number.One"]
HipHop_Reggae <- df[df$CDR.Genre == "Hip Hop;Reggae", "Weeks.at.Number.One"]
Pop_Reggae <- df[df$CDR.Genre == "Pop;Reggae", "Weeks.at.Number.One"]
ttest_ED_HipHop <- t.test(ED_Latin, HipHop_Reggae)
df_genres <- data.frame(
CDR.Genre = c("Electronic/Dance;Latin", "Hip Hop;Reggae", "Pop;Reggae"),
Weeks = c(14.0, 9.0, 6.5)
)
df_genres <- data.frame(
CDR.Genre = c("Electronic/Dance;Latin", "Hip Hop;Reggae", "Pop;Reggae"),
Weeks = c(14.0, 9.0, 6.5)
)
anova_result <- aov(Weeks ~ CDR.Genre, data = df_genres)
summary(anova_result)
df$z_score <- (df$`Weeks.at.Number.One` - mean(df$`Weeks.at.Number.One`, na.rm = TRUE)) /
sd(df$`Weeks.at.Number.One`, na.rm = TRUE)
head(df[order(-df$z_score), c("Song", "Artist", "Weeks.at.Number.One", "z_score")], 10)
ggplot(avg_weeks_genre, aes(x = reorder(CDR.Genre, mean_weeks), y = mean_weeks, fill = mean_weeks)) +
geom_bar(stat = "identity") +
coord_flip() +  # horizontal bars for readability
labs(title = "Average Weeks at #1 by Genre",
x = "Genre",
y = "Average Weeks at Number One") +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
theme_minimal()
