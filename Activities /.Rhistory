library(knitr)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(knitr)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
# Load the dataset
nonvoters_data <- read_csv("https://raw.githubusercontent.com/dwillis/jour405_files/refs/heads/main/nonvoters_data.csv")
# Look at the structure of the data
glimpse(nonvoters_data)
# Summary statistics of weights
summary(nonvoters_data$weight)
# Histogram of weights
ggplot(nonvoters_data, aes(x = weight)) +
geom_histogram(bins = 30, fill = "skyblue", color = "white") +
theme_minimal() +
labs(
title = "Distribution of Survey Weights",
x = "Weight",
y = "Count"
)
library(knitr)
# Count of respondents by voter category
nonvoters_data |>
count(voter_category) |>
mutate(percentage = n / sum(n) * 100)
# Calculate unweighted percentages
unweighted_by_voter_category <- nonvoters_data |>
# Filter out missing responses
filter(!is.na(Q21), Q21 > 0) |>
# Group by voter category and response
group_by(voter_category, Q21) |>
# Count responses in each group
summarize(count = n(), .groups = "drop_last") |>
# Calculate percentages within each voter category
mutate(total = sum(count),
percentage = count / total * 100) |>
ungroup()
# Create a more readable version with voting intentions as columns
unweighted_summary <- unweighted_by_voter_category |>
pivot_wider(
id_cols = voter_category,
names_from = Q21,
values_from = percentage,
names_prefix = "pct_"
) |>
rename(
"Yes (%)" = pct_1,
"No (%)" = pct_2,
"Unsure (%)" = pct_3
)
unweighted_summary
# YOUR TASK: Calculate the weighted percentages
# Use the weight variable to adjust the counts
weighted_by_voter_category <- nonvoters_data |>
# Filter out missing responses, same as before
filter(!is.na(Q21), Q21 > 0) |>
# Group by voter category and response
group_by(voter_category, Q21) |>
# Instead of counting, sum the weights
summarize(weighted_count = sum(weight), .groups = "drop_last") |>
# Calculate percentages based on weighted counts
mutate(weighted_total = sum(weighted_count),
weighted_percentage = weighted_count / weighted_total * 100) |>
ungroup()
weighted_summary <- weighted_by_voter_category |>
pivot_wider(
id_cols = voter_category,
names_from = Q21,
values_from = weighted_percentage,
names_prefix = "pct_"
) |>
rename(
"Yes (%)" = pct_1,
"No (%)" = pct_2,
"Unsure (%)" = pct_3
)
weighted_summary
comparison <- unweighted_summary |>
# Join the two tables to compare them
inner_join(weighted_summary, by = "voter_category", suffix = c("_unweighted", "_weighted")) |>
# Calculate the differences in percentage points
mutate(
yes_diff = `Yes (%)_weighted` - `Yes (%)_unweighted`,
no_diff = `No (%)_weighted` - `No (%)_unweighted`,
unsure_diff = `Unsure (%)_weighted` - `Unsure (%)_unweighted`
) |>
# Select just the differences for our table
select(voter_category, yes_diff, no_diff, unsure_diff) |>
rename(
"Yes (% point diff)" = yes_diff,
"No (% point diff)" = no_diff,
"Unsure (% point diff)" = unsure_diff
)
comparison
library(knitr)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
# Load the dataset
nonvoters_data <- read_csv("https://raw.githubusercontent.com/dwillis/jour405_files/refs/heads/main/nonvoters_data.csv")
# Look at the structure of the data
glimpse(nonvoters_data)
View(nonvoters_data)
